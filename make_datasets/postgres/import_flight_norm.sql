DROP TABLE IF EXISTS flight.route;
DROP TABLE IF EXISTS flight.schedule;
DROP TABLE IF EXISTS flight.flight;
DROP SCHEMA IF EXISTS flight;

create schema flight;
CREATE TABLE flight.route (ROUTE_ID INTEGER PRIMARY KEY, ORIGIN INT, DEST INT, DISTANCE FLOAT);

CREATE TABLE flight.schedule (SCHEDULE_ID INTEGER PRIMARY KEY, OP_CARRIER INT, CRS_DEP_HOUR FLOAT, CRS_DEP_MIN FLOAT, CRS_ARR_HOUR FLOAT, CRS_ARR_MIN FLOAT, ROUTE_ID INTEGER);

CREATE TABLE flight.flight (id INTEGER PRIMARY KEY, DEP_DELAY FLOAT, TAXI_OUT FLOAT, TAXI_IN FLOAT, ARR_DELAY FLOAT, DIVERTED INTEGER, ACTUAL_ELAPSED_TIME FLOAT, AIR_TIME FLOAT, DEP_TIME_HOUR FLOAT, DEP_TIME_MIN FLOAT, 
WHEELS_OFF_HOUR FLOAT, WHEELS_OFF_MIN FLOAT, WHEELS_ON_HOUR FLOAT, WHEELS_ON_MIN FLOAT, ARR_TIME_HOUR FLOAT, ARR_TIME_MIN FLOAT, MONTH_SIN FLOAT, MONTH_COS FLOAT, DAY_SIN FLOAT, DAY_COS FLOAT, WEEKDAY_SIN 
FLOAT, WEEKDAY_COS FLOAT, EXTRA_DAY_ARR INTEGER, EXTRA_DAY_DEP INTEGER, SCHEDULE_ID INTEGER);

\copy flight.route FROM 'route_dataset.csv' WITH (FORMAT CSV, NULL '');
\copy flight.schedule FROM 'schedule_dataset.csv' WITH (FORMAT CSV, NULL '');
\copy flight.flight FROM 'airlines_dataset.csv' WITH (FORMAT CSV, NULL '');
