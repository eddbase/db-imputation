DROP TABLE IF EXISTS join_table;

CREATE TABLE join_table(
    locn INTEGER,
    dateid INTEGER,
    rain INTEGER,
    snow INTEGER,
    maxtemp FLOAT,
    mintemp FLOAT,
    meanwind FLOAT,
    thunder INTEGER,
    zip INTEGER,
    rgn_cd FLOAT,
    clim_zn_nbr FLOAT,
    tot_area_sq_ft FLOAT,
    sell_area_sq_ft FLOAT,
    avghhi FLOAT,
    supertargetdistance FLOAT,
    supertargetdrivetime FLOAT,
    targetdistance FLOAT,
    targetdrivetime FLOAT,
    walmartdistance FLOAT,
    walmartdrivetime FLOAT,
    walmartsupercenterdistance FLOAT,
    walmartsupercenterdrivetime FLOAT,
    ksn INTEGER,
    inventoryunits FLOAT,
    subcategory INTEGER, 
    category INTEGER, 
    categoryCluster INTEGER,
    prize FLOAT,
    feat_1 FLOAT,
    population FLOAT,
    white FLOAT,
    asian FLOAT,
    pacific FLOAT,
    black FLOAT,
    medianage FLOAT,
    occupiedhouseunits FLOAT,
    houseunits FLOAT,
    families FLOAT,
    households FLOAT,
    husbwife FLOAT,
    males FLOAT,
    females FLOAT,
    householdschildren FLOAT,
    hispanic FLOAT
);


\copy join_table FROM 'join_table_retailer.csv' WITH (FORMAT CSV, NULL '');